<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Fewbytes</title><link href="http://fonts.googleapis.com/css?family=Gentium+Basic:400,700,400italic" rel=stylesheet type=text/css><link href="http://fonts.googleapis.com/css?family=Open+Sans:700,400" rel=stylesheet type=text/css><link rel=alternate type=application/rss+xml title="Fewbytes &#187; Feed" href=http://www.fewbytes.com/feed/><link rel=alternate type=application/rss+xml title="Fewbytes &#187; Comments Feed" href=http://www.fewbytes.com/comments/feed/><script type=text/javascript>window._wpemojiSettings={"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/www.fewbytes.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.3.1"}};!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);</script><style type=text/css>img.wp-smiley,img.emoji{display:inline!important;border:none!important;box-shadow:none!important;height:1em!important;width:1em!important;margin:0 .07em!important;vertical-align:-.1em!important;background:0 0!important;padding:0!important}</style><link rel=stylesheet id=parent-style-css href=/css/style.css type=text/css media=all><link rel=stylesheet id=brosco-style-css href=/css/style2.css type=text/css media=all><script type=text/javascript src=http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js></script></head><body class="page-template-default group-blog"><div id=page class="hfeed site"><a class="skip-link screen-reader-text" href=#content>Skip to content</a><header id=masthead class=site-header role=banner><div class=header-inside><div class=logo><a href=http://www.fewbytes.com/ title=Fewbytes rel=home><img src=http://www.fewbytes.com/wp-content/uploads/2015/11/fewbytes-logo1.png alt=Fewbytes></a></div><nav id=site-navigation class=main-navigation role=navigation><button class=menu-toggle>Primary Menu</button><div class=menu-top-bar-container><ul id=menu-top-bar class=menu><li id=menu-item-374 class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-77 current_page_item menu-item-374"><a href=/>Home</a></li><li id=menu-item-89 class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-89"><a href=/posts/>Blog</a></li></ul></div></nav></header><div id=content class=site-content><section id=primary class=content-area><main class=site-main><div class=single-post><div class=container><article class="post type-post status-publish"><header class=entry-header><h1 class=entry-title>Cronic Disease</h1><div class=entry-meta><time class="entry-date published posted-on">November 27, 2012</time> | <span class=entry-author>Avishai Ish-Shalom</span></div></header><div class=entry-content><p>There’s no denying Cron is one of the most useful tools in any *nix O/S but it&rsquo;s Every so often, there’s a cron job going haywire. Jobs fail to run and nobody notices, the sterile environment (no sane default PATH) eludes users and from time to time, a really bizarre critical issue - like cron filling up the disk with its mail output buffer because a job is looping and spewing an endless stream of error messages.</p><p>Cron&rsquo;s common usage is an omnipresent pain-point in my production systems, In particular, it&rsquo;s major shortcomings are:</p><ul><li>No job history. When did a job run? did it succeed? where is the output? (and no, mail or the local syslog are not acceptable)</li><li>output goes to a spool directory and will fill out your diskspace if the job is misbehaving</li><li>Job run environment is very different from the user’s and not trivial to recreate</li><li>No triggers other than schedule. I see many jobs that wake up every minute just to check a trigger/condition.</li><li>No support for &ldquo;test run&rdquo; or manual trigger</li><li>Hard to monitor</li><li>No built-in locks</li><li>No support for distributed operations; many cron jobs today needs to be run periodically on one node in a cluster.</li></ul><p>The main reason for these issues is that, like so many other *nix tools, cron was designed for a single instance, both from the technical and usage perspectives. It makes sense to have job results sent by mail when you have 3 servers, but if you get emails from 100 servers&mldr;. good luck with that. Same goes for logging the output; it’s sane (although inconvenient) to lookup a job’s history in a log on one server but not on a cluster.</p><p>The cron use case demonstrates an often forgotten truth about scaling: scaling includes the human component. Does cron scale computation-wise? absolutely. Is it still maintainable? not so much.</p><p>I would like a tool that runs maintenance jobs on a cluster and its nodes and tends to itself as much as possible while still being pluggable. It’s rare (and wrong) for a tool to be able to do everything, so pluggability and a good API are essential.</p><h2 id=what-can-be-done>What can be done</h2><h3 id=use-a-build-server>use a build server</h3><p>The easiest resolution is not to use cron for anything other than simple internal node maintenance tasks. As a replacement, use a build server (like <a href=http://jenkins-ci.org/>Jenkins</a>) - build servers support distributed scheduled jobs (or on a trigger), maintain a job’s history and output and have many plugins and triggers.</p><h3 id=submit-passive-checks-to-nagios>Submit passive checks to Nagios</h3><p>Every cron job you care about should do this. By using <a href=http://www.nagios.org/>Nagios</a> you get instant limited job history, failure monitoring and the chance to respond automatically if a job failed to complete.</p><h3 id=use-a-generic-wrapper>Use a generic wrapper</h3><p>All but one of cron’s major issues can be easily fixed with a single generic wrapper. The code for sending passive checks to nagios, handle output and save it somewhere for later, write a history entry, check for lock files, etc. - it’s all very generic. Write a decent wrapper now and thank yourself later.</p></div></article></div><nav class="navigation post-navigation" role=navigation><h1 class=screen-reader-text>Post navigation</h1><div class=nav-links style=display:block><div class=nav-previous></div><div class=nav-next><a href=/it-is-not-ops/ rel=next>Next <span class=meta-nav></span></a></div></div></nav></div></main></section></div><footer id=colophon class=site-footer role=contentinfo><div class=site-info>&copy; Fewbytes</div></footer></div></body></html>